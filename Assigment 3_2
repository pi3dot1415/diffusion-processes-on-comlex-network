#source: https://www.youtube.com/watch?v=NRgfgtzIhBQ
#file 1 - downloading data

import praw
import networkx as nx
import csv

reddit = praw.Reddit(
    client_id="nvvtuctctycytcyt",
    client_secret="byyctcutdrddeezudyif",
    password="********",
    user_agent="http://localhost:8888",
    username="name",
) #obviously different
topic= "ChatGPT"
print(topic)
subreddit = reddit.subreddit(topic)
subs=subreddit.hot(limit=25)
#listOfConnections=[] 

with open(f'data_file_topic_{topic}.csv', 'w', newline='') as file:
    writer = csv.writer(file)

    for s in subs:
        print(s.author) #autor tematu
        #listOfConnections.append([0, str(s.author), None])
        writer.writerow([0, str(s.author)])
        x=s.comments
        for xs in x:
            try:
                writer.writerow([1, str(xs.author), str(s.author)])
            except:
                break
            #listOfConnections.append([1, str(xs.author), str(s.author)])
            y=xs.replies
            for ys in y:
                try:
                    writer.writerow([2, str(ys.author), str(xs.author)])
                except:
                    break
                #listOfConnections.append([2, str(ys.author), str(xs.author)])
                z = ys.replies
                for zs in z:
                    try:
                        writer.writerow([3,str(zs.author), str(ys.author)])
                        #listOfConnections.append([3,str(zs.author), str(ys.author)])
                    except:
                        break
                
file.close()
